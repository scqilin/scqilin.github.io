<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>测试lib</title>
    <script src="lib.js"></script>
</head>
<body>
<canvas id="canvas" width="500" height="500"></canvas>
<script type="text/javascript">
    var ctx = document.getElementById('canvas').getContext('2d');
    ctx.fillRect(10,10,40,40);
    /*var vertexShaderSource = "" +
        "attribute vec4 pos;" +
        "uniform mat4 xz;" +
        "uniform mat4 u_vmatrix;" +
        "void main(){" +
        "gl_Position = xz*u_vmatrix*pos;" +
        "gl_PointSize = 10.0;" +
        "}";
    var fragmentShaderSource = "" +
        "void main(){" +
        "gl_FragColor = vec4(1.0,.0,.0,1.0);" +
        "}";
    var program = iniShaders(ctx,vertexShaderSource,fragmentShaderSource);
    var data = new Float32Array([
        0.0,0.0,
        0.5,0.0,
        0.0,0.5,
    ])
    bindAttributeBuffer(ctx,'pos',data,program,2);

    function normalize(v){
        var sum = 0;
        for (var i=0;i< v.length;i++){
            sum += v[i] * v[i];
        }
        var result = Math.sqrt(sum);
        for(var j=0;j< v.length; j++){
            v[i] = v[i] / result;
        }
    }

    function cross(a,b){
        var nX = a[1] * b[2] - a[2] * b[1];
        var nY = a[2] * b[0] -a[0] * b[2];
        var nZ = a[0] * b[1] - a[1] * b[0];

        return new Float32Array([nX,nY,nZ]);
    }

    function dot(a,b){
        return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];
    }

    function minus(a , b){
        return new Float32Array([a[0] - b[0], a[1] - b[1] , a[2] - b[2]]);
    }

    function getVMatrix(){

        var eye = new Float32Array([0.0,0.5,-0.2]);
        var lookat = new Float32Array([0.0,0.0,0.0]);
        var up = new Float32Array([0,1,1]);

        var zA = minus(eye , lookat);
        normalize(zA);

        normalize(up);
        var xA = cross(up, zA);

        var yA = cross(zA,xA);

        return new Float32Array([
            xA[0],yA[0],zA[0], 0,
            xA[1],yA[1],zA[1], 0,
            xA[2],yA[2],zA[2], 0,
            - dot(xA,eye), -dot(yA,eye),-dot(zA,eye),1

        ])

    }

    var u_vmatrixLocation = ctx.getUniformLocation(program,'u_vmatrix');
    var mx = getVMatrix(); // 视图矩阵
    ctx.uniformMatrix4fv(u_vmatrixLocation,false,mx);

    var angle = 0.0;
    function run() {
        angle += 1.0;
        xf = createXZMatrix(angle);
        var xzLoaction = ctx.getUniformLocation(program,'xz');
        ctx.uniformMatrix4fv(xzLoaction,false,xf);

        ctx.drawArrays(ctx.TRIANGLES,0,3);
        ctx.drawArrays(ctx.POINTS,0,3);
        //setTimeout(run,100);
    }
    run();*/
</script>
</body>
</html>